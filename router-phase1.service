[Unit]
Description=Router Phase 1 AI Research Assistant
After=network.target
Wants=network.target
# Uncomment the following lines if Ollama should be started automatically
# Requires=ollama.service
# After=ollama.service

[Service]
Type=simple
User=router
Group=router
WorkingDirectory=/opt/router-phase1
Environment=OLLAMA_HOST=http://127.0.0.1:11434
Environment=OLLAMA_MODEL=llama3.2:1b
Environment=PYTHONPATH=/opt/router-phase1
ExecStart=/opt/router-phase1/run.sh
ExecReload=/bin/kill -s HUP $MAINPID
Restart=always
RestartSec=5
StandardOutput=journal
StandardError=journal
SyslogIdentifier=router-phase1
# Timeout for startup and shutdown
TimeoutStartSec=30
TimeoutStopSec=30

# Security settings
NoNewPrivileges=yes
PrivateTmp=yes
ProtectHome=yes
ProtectSystem=strict
ReadWritePaths=/opt/router-phase1
ProtectKernelTunables=yes
ProtectKernelModules=yes
ProtectControlGroups=yes

# Resource limits
MemoryLimit=2G
CPUQuota=200%

[Install]
WantedBy=multi-user.target